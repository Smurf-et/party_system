PvpParty = {}
Tunnel.bindInterface("PvpParty-system", PvpParty)
Server = Tunnel.getInterface("PvpParty-system")
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARIABLES
-----------------------------------------------------------------------------------------------------------------------------------------
local PartyManager = module('party_system', 'server/utils/PartyManager')
local currentParty = nil
local currentTeam = nil
-----------------------------------------------------------------------------------------------------------------------------------------
-- THREAD
-----------------------------------------------------------------------------------------------------------------------------------------
CreateThread(function()
    while true do
        waitTimer = 1000
        local ped = PlayerPedId()

        if currentParty ~= nil then
            waitTimer = 4
            if currentTeam == 'red' then
                drawTxt("TIME: ~r~RED~w~",4,0.5,0.93,0.50,255,255,255,255)
            elseif currentTeam == 'blue' then
                drawTxt("TIME: ~b~BLUE~w~",4,0.5,0.93,0.50,255,255,255,255)
            end
            if PvpParty.isDead() then
               Server.checkIsLastPlayer(currentParty)
            end
        end
        Wait(waitTimer)
    end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- GET CURRENT PARTY
-----------------------------------------------------------------------------------------------------------------------------------------
function PvpParty.getCurrentParty()
    return currentParty
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- GET CURRENT TEAM
-----------------------------------------------------------------------------------------------------------------------------------------
function PvpParty.getCurrentTeam()
    return currentTeam
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- MANAGE CURRENT PARTY
-----------------------------------------------------------------------------------------------------------------------------------------
function PvpParty.manageCurrentParty(boolean)
    currentParty = boolean
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- MANAGE CURRENT TEAM
-----------------------------------------------------------------------------------------------------------------------------------------
function PvpParty.manageCurrentTeam(boolean)
    currentTeam = boolean
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- RESET VALUES
-----------------------------------------------------------------------------------------------------------------------------------------
function PvpParty.resetValues()
    currentParty = nil
    currentTeam = nil
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- IS DEAD
-----------------------------------------------------------------------------------------------------------------------------------------
function PvpParty.isDead()
    local ped = PlayerPedId()
    local health = GetEntityHealth(ped)
    if health <= 101 then
        return true
    else
        return false
    end
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- TELEPORT PLAYERS
-----------------------------------------------------------------------------------------------------------------------------------------
function PvpParty.teleportPlayers(x, y, z)
    SetEntityCoords(PlayerPedId(), x + 0.0001, y + 0.0001,z + 0.0001, 1, 0, 0, 1)
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- DRAWTXT
-----------------------------------------------------------------------------------------------------------------------------------------
function drawTxt(text,font,x,y,scale,r,g,b,a)
	SetTextFont(font)
	SetTextScale(scale,scale)
	SetTextColour(r,g,b,a)
	SetTextOutline()
	SetTextCentre(1)
	SetTextEntry("STRING")
	AddTextComponentString(text)
	DrawText(x,y)
end